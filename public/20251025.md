---
title: 'rpi-imagerがうごかない！UART probeを使う'
tags:
  - 'RaspberryPi'
private: false
updated_at: ''
id: null
organization_url_name: techno_robocup
slide: false
ignorePublish: false
---
# ことの発端

特に深い理由なく、「Pythonの環境が少し汚くなってきたから、OSを書き直してきれいにするか」という軽い気持ちでラズパイのOSを書き直しました。

しかし、ここから大惨事がはじまりました。

# 何が起きたか

なぜかラズパイをどれだけ書き直したりさいきどうしたりしてもWi-Fiに繋がりませんでした。

しっかりとctrl+shift+xでconfigurationも適用した状態で書き込みをし、Wi-FiのSSIDもパスワードもあっていることを確認していました。

しかし、それでも上手くいかなかった。

# どうしたか

ラズパイのUART probeがあったので、それを使ってデバッグしてみることにしました。（以下の画像のようなもの。）

![raspberrypi probel](https://www.raspberrypi.com/documentation/microcontrollers/debug-probe.html)

# どのように使う？

![raspberrypi probe instructions](https://www.raspberrypi.com/documentation/microcontrollers/debug-probe.html)

このようなものが入っていると思います。

これらのうち、本体（一番左のもの）、そしてメスのジャンパー線のようなものが出ているやつ（画像で言う２番）のものを使用します。

まずデバッグチップをパソコンに接続し、チップの赤色のLEDが点灯することを確認します。

そして、ジャンパー線のようなものをチップの`U`と書いてある方につなぎます。

その後、適切にジャンパー線を配線します（GNDはGNDはに、TXはRXに、RXはTXにという具合です）。

ピンは以下のサイトが参考になると思います。

[ラズパイのピン配置](https://www.bioerrorlog.work/entry/raspberry-pi-pinout)

# つないでどうする？

ラズパイを起動するのですが、それの前にラズパイ側でUARTを有効化する必要があります。

rpi-imagerで書き終えたら、bootfsというパーティション内にあるconfig.txtを開き、末尾まで行く。

そして、

```config
[all]
enable_uart=1
```

と記述することでUARTが有効化されます。

# UART通信をする方法

WindowsではTeraTermというソフトがあるようです。そちらを使うと簡単にできるようですね。

[https://teratermproject.github.io/](teratermの公式ページ)

linux, MacOSだとcuコマンドが一番手っ取り早いと思います。

USBデバイスを`/dev/ttyACM0`だとすると、

```bash
cu -s 115200 -l /dev/ttyACM0
```

で接続をすることができます。

# 接続して分かったこと

自分が設定していたユーザー名、パスワードで入ることができなかった。

自分は普段遣いのOSとしてUbuntuを使用しているが、どうもそれが原因のようだ。

Windowsのrpi-imagerから書き込みをしたところ、無事Wi-Fiに接続されて普通にSSHをすることができた。

マジョリティのOSを使うことの大切さを感じた。

しかし、UART probeを一度も使わずに物事が進んでいくことも考えられたので、良い経験ができたということで今回は満足している。
